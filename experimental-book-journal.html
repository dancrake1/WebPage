<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Photography Journal</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@600;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@700;800;900&display=swap" rel="stylesheet">
  <link href='https://fonts.googleapis.com/css2?family=Inter:wght@900&display=swap'rel="stylesheet">

  <style>
    :root{
      /* Outer stays the color you like */
      --outer-bg: #ede6d6;

      /* Warmer, lighter paper base (less grey) */
      --paper: #faeed9;  /* try #f8edd6 or #f9ecd7 for tiny shifts */
      
      /* Blob style variables - reuse the exact style you like */
      --blob-color: rgba(224,31,45,0.98);
      --blob-hue-opacity: 0.40;
      --blob-density-opacity: 0.60; 
      --blob-burn-opacity: 0.18;
      --blob-grain-opacity: 0.24;
      --blob-grain2-opacity: 0.12;
      
      /* Text overlay variables - darker red to compensate for normal blend mode */
      --text-overlay-color: rgba(180,25,35,1);
    }
    @font-face {
    font-family: 'Futura Bold';
    src: url('../fonts/FuturaBold.woff2') format('woff2'),      /* Best compression */
         url('../fonts/FuturaBold.woff') format('woff'),        /* Good fallback */
         url('../fonts/FuturaBold.otf') format('opentype');     /* Your OTF file */
    font-weight: bold;
    font-display: swap; /* Better loading performance */
    }

    @font-face {
        font-family: 'CMM';
        src: url('fonts/CMM Coda/CMMCoda-MonoSans.woff') format('woff2');     /* Best compression */
        font-display: swap; /* Better loading performance */
    }

    *{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}

    body{
      font-family:'Courier Prime',monospace;
      background:var(--outer-bg);
      color:#111;
      overflow-x:hidden;
      line-height:1.7;
      position:relative;
    }

    /* Index */
    .index-section{
      min-height:100vh;
      padding:5rem;
      display:flex;
      align-items:center;
      position:relative;
      z-index:10;
      background:var(--outer-bg);
    }
    .hero-image{
      position:absolute; top:22%; right:6%;
      width:500px; height:600px;
      background:url('images/IMG_6354.JPG') center/cover;
      border-radius:6px; opacity:.65; z-index:1;
    }
    
    /* Hero image with blob support */
    .hero-image-blob {
      position:absolute; top:22%; right:6%;
      width:500px; height:600px;
      border-radius:6px; opacity:.65; z-index:1;
      overflow:hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      mix-blend-mode: multiply;
      transition: filter .25s ease, box-shadow .25s ease, mix-blend-mode .25s ease, transform .25s ease;
    }
    .hero-image-blob img { width: 100%; height: 100%; object-fit: cover; display: block; filter: brightness(.96) contrast(.96); }
    /* No hover effects for hero image */
    /* Allow bleeding hero blobs to overflow */
    .hero-image-blob.has-spot-bleed {
      overflow: visible;
    }
    .index-container{max-width:800px;width:100%;position:relative;z-index:2}
    .site-header{font-size:1.1rem;margin-bottom:3rem;color:#2a2a2a}
    .index-list{list-style:none;font-size:1.3rem;line-height:1.5;letter-spacing:.02em;color:#111}
    .index-list li{margin-bottom:.8rem}
    .index-list a{text-decoration:none;color:inherit}

    /* Journal wrapper */
    .journal-wrapper{background:var(--outer-bg);padding:4rem 0}

    /* BOOK: match reference – lighter, warmer, with visible grain */
    .journal-content{
      width:95%;
      margin:0 auto;
      position:relative;

      /* Base tone */
      background-color:var(--paper);

      /* Textures + warm tint layer.
         Order matters: tint first (solid), then fibers, then paper grain. */
      background-image:
        linear-gradient(rgba(214,168,111,0.10), rgba(214,168,111,0.10)), /* warm tint */
        url('https://www.transparenttextures.com/patterns/paper-fibers.png'),  /* fibers */
        url('https://www.transparenttextures.com/patterns/paper.png');        /* grain */
      background-repeat: repeat, repeat, repeat;
      background-size: auto, auto, auto;

      /* Make the tint actually warm the textures */
      background-blend-mode: multiply, normal, normal;

      /* Gentle elevation (reduce if you want it flatter) */
      box-shadow:0 2px 12px rgba(0,0,0,.10);
      z-index:1;
    }

    /* Subtle inner vignette + extra fiber pass (so it’s grainy but not grey) */
    .journal-content::before{
      content:'';
      position:absolute; inset:0; pointer-events:none;
      background:
        radial-gradient(120% 120% at 50% 50%, rgba(0,0,0,.035) 0%, rgba(0,0,0,.02) 55%, rgba(0,0,0,.045) 100%),
        url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      mix-blend-mode:multiply;
      opacity:.55; /* lower if still too dark; raise to .65 if you want more grain */
    }

    
    /* Spreads */
    .book-spread{
      position:relative;
      width:100%;
      height:100vh;
      min-height:1400px;
      display:flex;
      background:transparent;
      overflow:hidden;
    }

    /* Spreads */
    .book-spread {
      position: relative;
      width: 100%;
      height: 100vh;
      min-height: 1400px;
      display: flex;
      background: transparent; /* paper is on journal-content */
      overflow: hidden;
    }

    /* Center Spine (as before) */
    .center-spine {
      position: absolute;
      left: 50%;
      top: 0;
      bottom: 0;
      width: 4px;
      transform: translateX(-50%);
      z-index: 50; /* Lower than blob overlays */
      background: linear-gradient(to right,
        rgba(0,0,0,0.09) 0%,
        rgba(0,0,0,0.05) 20%,
        rgba(0,0,0,0.03) 50%,
        rgba(0,0,0,0.05) 80%,
        rgba(0,0,0,0.09) 100%);
    }

    .page-left, .page-right {
      width: 50%;
      height: 100%;
      position: relative;
      padding: 60px;
      overflow: hidden;
      transform-style: preserve-3d;
      z-index: 2;
    }
    .page-left  { transform: perspective(3000px) rotateY(0.5deg);  transform-origin: right center;  padding-right: 64px; }
    .page-right { transform: perspective(3000px) rotateY(-0.5deg); transform-origin: left  center;  padding-left:  64px; }

    /* Gentle page shadows at the spine */
    .page-left::before, .page-right::before{
      content:'';
      position:absolute; top:0; bottom:0; width:20px; z-index:50; pointer-events:none;
    }
    .page-left::before  { right:0;  background: linear-gradient(to left,  rgba(0,0,0,0.10) 0%, rgba(0,0,0,0.05) 50%, transparent 100%); }
    .page-right::before { left:0;   background: linear-gradient(to right, rgba(0,0,0,0.10) 0%, rgba(0,0,0,0.05) 50%, transparent 100%); }

    .book-element { position: absolute; z-index: 10; }

    /* Monospace copy to match inspiration */
    .lorem-block {
      font-family: 'Courier Prime', monospace;
      font-size: 13px;
      font-weight: var(--font-weight, 500);
      line-height: var(--line-height, 1.55);
      color: #2a2a2a;
      text-align: justify;
      column-count: var(--columns, 2);
      column-gap: var(--column-gap, 30px);
      column-width: var(--column-width, auto);
      opacity: 0.9;
    }
    .lorem-block.single-column{ column-count:1; }

    /* Standard text block - single column, larger font */
    .text-block {
      font-family: 'Courier Prime', monospace;
      font-size: 14px;
      font-weight: 400;
      line-height: 1.6;
      color: #1a1a1a;
      text-align: left;
      opacity: 0.85;
    }

    .bold-interruption,
    .entry-title,
    .book-notes,
    .section-number,
    .metadata-stamp,
    .attribution {
      font-family: 'Courier Prime', monospace;
      letter-spacing: 0.01em;
    }
    .bold-interruption { font-size: 3.5rem; font-weight: 400; line-height: .95; color: #1a1a1a; z-index:70; }
    .section-number   { font-size: 1rem;  opacity: .6; color:#2a2a2a; }
    .entry-title      { font-size: 1.5rem; font-weight: 600; color:#2a2a2a; }
    .book-notes       { font-size: 1.1rem; line-height:1.3; opacity:.85; }
    .metadata-stamp   { font-size: 1.05rem; color:#1a1a1a; }
    .attribution      { font-size: .85rem; color:#2a2a2a; opacity:.7; }
    .black-block      { background: rgba(0,0,0,0.05); }

    /* Images – blend into paper, lift on hover */
    .book-image {
      overflow: hidden;
      cursor: zoom-in;
      position: absolute;
      z-index: 2;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      mix-blend-mode: multiply;              /* printed look */
      transition: filter .25s ease, box-shadow .25s ease, mix-blend-mode .25s ease, transform .25s ease;
      background: transparent;
    }
    /* Allow bleeding images to overflow */
    .book-image.has-spot-bleed {
      overflow: visible;
    }
    /* When an image hosts a colored spot, avoid double-multiplying only on hover */
    .book-image.has-spot:hover { mix-blend-mode: normal; }
    .book-image img { width: 100%; height: 100%; object-fit: cover; display: block; filter: brightness(.96) contrast(.96); }
    .book-image:hover {
      filter: brightness(1) contrast(1);
      mix-blend-mode: normal;                /* rise from page */
      box-shadow: 0 6px 18px rgba(0,0,0,0.18);
    }
    .book-image.spine-adjacent { box-shadow: 0 4px 15px rgba(0,0,0,0.12); }
    .book-image.spine-spanning { box-shadow: 0 6px 20px rgba(0,0,0,0.18); }

    /* Lightbox (unchanged) */
    .lightbox {
      display: none;
      position: fixed; inset: 0;
      background: rgba(251, 248, 243, 0.95);
      z-index: 1000;
      padding: 2rem;
      cursor: zoom-out;
      opacity: 0;
      transition: opacity 0.4s ease-out;
    }
    .lightbox.active { display:flex; align-items:center; justify-content:center; opacity:1; }
    .lightbox-content { width:95vw; height:95vh; transform:scale(.8); transition:transform .4s cubic-bezier(.25,.46,.45,.94); }
    .lightbox.active .lightbox-content { transform:scale(1); }
    .lightbox-content img { width:100%; height:100%; object-fit:contain; }
    .lightbox-close { position:absolute; top:20px; right:40px; color:#1a1a1a; font-size:40px; cursor:pointer; }
    

    /* Container on each photo that will host the spot */
    .book-image { position: absolute; } /* you already have this */
    .book-image .image-spot {
    position: absolute;
    inset: 0;
    pointer-events: none;
    isolation: isolate;           /* keep blends local to this image */
    }

    /* Contained vs. bleed */
    .book-image .image-spot--contained svg { overflow: hidden; }
    .book-image .image-spot--bleed { 
      overflow: visible; 
      position: absolute;
      inset: -50px; /* Extend beyond image boundaries */
      pointer-events: none;
      z-index: 101; /* Above center spine */
    }
    .book-image .image-spot--bleed svg { overflow: visible; }
    
    /* Ensure blob overlays render above spine effects */
    .book-image .image-spot {
      z-index: 60; /* Above center spine which is now z-index 50 */
    }

    /* Size/placement of the SVG over the image (tweak the translate if needed) */
    .book-image .image-spot svg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    }

    /* Two-layer recipe matching the reference (stronger background interaction) */
    .image-spot .hue-layer     { mix-blend-mode: color;      opacity: 0.40; }
    .image-spot .density-layer { mix-blend-mode: overlay;    opacity: 0.60; }
    .image-spot .burn-layer    { mix-blend-mode: color-burn; opacity: 0.18; }

    /* Add some paper-like grain inside the spot (very subtle) */
    .image-spot .grain { mix-blend-mode: multiply; opacity: 0.24; }
    .image-spot .grain2 { mix-blend-mode: multiply; opacity: 0.12; }

    /* Optional: if you ever have a global blend on .book-image, neutralize it here */
    .book-image .image-spot { mix-blend-mode: unset; }

    /* Clipper that matches the journal boundary. Place inside .journal-content */
    .title-clip {
    position: absolute;
    inset: 0;                /* fills the book */
    overflow: hidden;        /* trims the title at book edges */
    pointer-events: none;
    z-index: 69;             /* below images with z>69, above page bg */
    }

    /* Display title: sharper grotesk, tighter rows */
    .display-title {
    position: absolute;
    z-index: 70;
    pointer-events: none;
    
    /* Updated font stack */
    /* font-family: 'Oswald', 'Bebas Neue', 'Barlow Condensed', sans-serif; */
    font-family: 'Futura Bold', sans-serif;
    font-weight: bold; 
    /* font-family: 'CMM', sans-serif; */
    font-weight: 1000;                /* Black weight */
    font-stretch: condensed;         /* Make it more condensed */
    font-size: clamp(3rem, 9vw, 10rem);
    line-height: 0.9;              /* Even tighter */
    letter-spacing: -0.025em;        /* Tighter spacing like the image */
    
    color: rgb(255, 74, 58, 0.85);
    mix-blend-mode: multiply;
    filter: url(#textGrain);
}

    /* Per-line control (for the stair-step indents) */
    .display-title .line{
    display: block;
    transform: translateX(var(--indent,0ch));
    }
    .display-title .line + .line { margin-top: var(--row-gap); }

    /* Optional: a hairline stroke to keep edges crisp on pale areas */
    .display-title.crisp {
    -webkit-text-stroke: 0.02em rgba(0,0,0,0.06);
            text-stroke: 0.02em rgba(0,0,0,0.06);
    }

    /* 1) Ball indent: the float that text wraps around */
    .ball-copy{
    --diameter: 44ch;              /* overall ball size (in ch to match mono) */
    --indent-side: left;           /* put it on 'left' or 'right' */
    --seam-width: 1.2ch;           /* thickness of the "white" line */
    --seam-soften: 10px;           /* blur/softness of edges */
    --seam-curve: 0.65;            /* 0..1: how "open" the parabola feels */
    width: 400px;                  /* paragraph width in pixels for consistency */
    line-height: 2;             /* tighten rows */
    font-family: "Courier Prime", monospace;
    font-size: 12px;
    color: #2a2a2a;
    }

    /* invisible float that creates the true round indent */
    .ball-copy::before{
    content:"";
    float: var(--indent-side);
    width: var(--diameter);
    height: var(--diameter);
    shape-outside: circle(50% at 50% 50%);   /* circular cutout */
    /* keep it invisible */
    shape-margin: 0; 
    }

    /* the paragraph itself */
    .ball-copy p{
    text-align: left;
    margin: 0;
    }

    /* 2) Seam “eraser” that matches your paper background so it feels natural */
    .ball-seam {
    position: absolute;
    inset: 0;
    pointer-events: none;
    /* Mimic your journal paper so the erased line looks printed-out */
    background-color: var(--paper);
    background-image:
        linear-gradient(rgba(214,168,111,0.10), rgba(214,168,111,0.10)),
        url('https://www.transparenttextures.com/patterns/paper-fibers.png'),
        url('https://www.transparenttextures.com/patterns/paper.png');
    background-blend-mode: multiply, normal, normal;
    /* We’ll clip this with an SVG path via mask */
    -webkit-mask: var(--seam-mask);
            mask: var(--seam-mask);
    }

    /* helpful utility if you want the indent on the right for a mirrored layout */
    .ball-copy.right { --indent-side: right; }

    /* Mobile */
    @media (max-width: 768px) {
      .hero-image { width: 200px; height: 300px; right: 5%; top: 15%; opacity: .2; }
      .index-list { font-size: 1.1rem; }
      .book-spread { flex-direction: column; height: auto; }
      .page-left, .page-right { width: 100%; padding: 30px; min-height: 100vh; transform: none; }
      .center-spine { display: none; }
    }
  </style>
</head>
<body>
  <!-- SVG Filters for text grain effect -->
  <svg width="0" height="0" style="position: absolute;">
    <defs>
      <filter id="textGrain" x="0%" y="0%" width="100%" height="100%">
        <feTurbulence type="fractalNoise" baseFrequency="0.45" numOctaves="1" seed="42"/>
        <feColorMatrix type="saturate" values="0" />
        <feComponentTransfer>
          <feFuncA type="linear" slope="0.08"/>
        </feComponentTransfer>
        <feComposite operator="screen" in2="SourceGraphic"/>
      </filter>
    </defs>
  </svg>

  <!-- Index Section -->
  <section class="index-section">
    <div class="hero-image-blob book-image" 
         data-img="images/IMG_6354.JPG"
         data-blob="shape:square,size:0,x:800,y:800,bleed:y,seed:42,rotation:0">
      <img src="images/IMG_6354.JPG" alt="Hero image">
    </div>
    <div class="index-container">
        <h1 class="site-header">places, faces and databases...<br>fotos</h1>
      <ul class="index-list">
        <li><a href="#spread-1">01 - a sunny day at the beach</a></li>
        <li><a href="#spread-2">02 - india adjacent</a></li>
        <li><a href="#spread-3">03 - a great british strawberry</a></li>
        <li><a href="#spread-4">04 - a very big apple</a></li>
        <li><a href="#spread-5">05</a></li>
      </ul>
    </div>
  </section>

  <!-- Journal -->
  <div class="journal-wrapper">
    <div class="journal-content">
      <!-- SPREAD 1 -->
      <div class="book-spread" id="spread-1">
        <div class="center-spine"></div>
        <span class="section-number book-element" style="top: 20px; left: 40px;">01</span>

        <div class="book-image book-element" style="top:0%; left:0%; width:50%; height:100%;" data-img="images/severn_sisters/hills.jpg">
          <img src="images/severn_sisters/hills.jpg" alt="Hills landscape">
        </div>
        <div class="book-image book-element" style="top: 25%; left: 50%; width: 16%; height: 28%;" data-img="images/severn_sisters/horse.jpg">
          <img src="images/severn_sisters/horse.jpg" alt="Portrait 1">
        </div>
        <div class="book-image book-element" style="top: 25%; left: 66.5%; width: 16%; height: 28%;" data-img="images/severn_sisters/beems.jpg">
          <img src="images/severn_sisters/beems.jpg" alt="Portrait 2">
        </div>
        <div class="book-image book-element" style="top: 25%; left: 83%; width: 16.3%; height: 28%;" data-img="images/severn_sisters/van.jpg">
          <img src="images/severn_sisters/van.jpg" alt="Portrait 3">
        </div>
        <div class="book-image book-element" 
            style="top: 63%; left: 50%; width: 40%; height: 30%;" 
            data-img="images/severn_sisters/boat.jpg"
            data-blob="size:1,seed:11,rotation:-6,x:750,y:560, bleed:y">
        <img src="images/severn_sisters/boat.jpg" alt="Boat composition">
        </div>

        <!-- Text -->

        <div class="display-title narrow crisp book-element"
        style="top: 2%; right: 0%; width: 25%;">
            <span class="line" style="--indent: 0ch">Sev</span>
            <span class="line" style="--indent: 1ch">ern</span>
            <span class="line" style="--indent: 0.5ch">Sis</span>
            <span class="line" style="--indent: 1.2ch">ters</span>
        </div>
        <div class="lorem-block book-element" style="top: 785px; left: 700px; width: 35%; opacity: 0.4; column-gap: 30px;">
            the usual january walk taken post the over-endulgance of christmas and attempts to reach a month sober - this day was the day it ended.
          </div>
        <span class="attribution book-element" style="top: 250px; left: 680px;">The Annual Sobriety Stroll ©late jan 2025</span>

      </div>

      <!-- SPREAD 2 -->
      <div class="book-spread" id="spread-2" style="min-height: 3465px;">
        <div class="center-spine"></div>

        <span class="section-number book-element" style="top: 40px; right: 60px;">02</span>

        <div class="book-image book-element" style="top: 0%; left: 50%; width: 50%; height: 20%;" data-img="images/srilanka/train_bleak.jpg">
          <img src="images/srilanka/train_bleak.jpg" alt="Bleak Train">
        </div>

        <div class="book-image book-element" style="top: 14%; left: 0%; width: 50%; height: 25%;" data-img="images/srilanka/tree_light.jpg">
          <img src="images/srilanka/tree_light.jpg" alt="Tree Light">
        </div>

        <div class="book-image book-element" 
             style="top: 24%; left: 65%; width: 20%; height: 12%;" 
             data-img="images/srilanka/fruit.JPG"
             data-blob="shape:square,size:1.5,seed:42,rotation:0,x:850,y:850,bleed:y">
          <img src="images/srilanka/fruit.JPG" alt="Fruit">
        </div>

        <div class="book-image book-element" style="top: 41%; left: 50%; width: 45%; height: 25%;" data-img="images/srilanka/train_blur.JPG">
          <img src="images/srilanka/train_blur.JPG" alt="Train Blur">
        </div>
        <!-- multiple versions softens of image blob -->
        <div class="book-image book-element" style="top: 42%; left: 14%; width: 18%; height: 11%;" data-img="images/srilanka/woman.JPG">
          <img src="images/srilanka/woman.JPG" alt="Woman">
        </div>
        <div class="book-image book-element" style="top: 42%; left: 14%; width: 18%; height: 11%;" 
            data-img="images/srilanka/woman.JPG"
            data-blob="size:2,seed:45,rotation:-6,x:750,y:860, bleed:y">
            <img src="images/srilanka/woman.JPG" alt="Woman">
          </div>
          <div class="book-image book-element" style="top: 54%; left: 14%; width: 18%; height: 11%;" 
          data-img="images/srilanka/tracks.jpg">
          <img src="images/srilanka/tracks.jpg" alt="Tracks">
        </div>

        <div class="book-image book-element" style="top: 68%; left: 2%; width: 25%; height: 16%;" data-img="images/srilanka/beach.jpg">
          <img src="images/srilanka/beach.jpg" alt="Beach">
        </div>
        <div class="book-image book-element" 
            style="top: 85%; left: 25%; width: 25%; height: 15%;" 
            data-img="images/srilanka/beach_sunset.jpg">
            <!-- data-blob="shape:square,size:1.5,seed:42,rotation:90,x:150,y:200,bleed:y"> -->
            <img src="images/srilanka/beach_sunset.jpg" alt="Beach">
          </div>
        <div class="book-image book-element" style="top: 67%; left: 75%; width: 20%; height: 14%;" data-img="images/srilanka/boat_shadow.JPG">
          <img src="images/srilanka/boat_shadow.JPG" alt="Surfboard">
        </div>
        <div class="book-image book-element" 
            style="top: 80%; left: 55%; width: 15%; height: 5%;" 
            data-img="images/srilanka/lotta.JPG"
            data-blob="shape:square,size:1.5,seed:42,rotation:0,x:850,y:850,bleed:y">
            <img src="images/srilanka/lotta.JPG" alt="Surfboard">
          </div>
          <div class="book-image book-element" 
            style="top: 86%; left: 68%; width: 18%; height: 13%;" 
            data-img="images/srilanka/jack.JPG"
            data-blob="shape:square,size:1.5,seed:42,rotation:90,x:850,y:600,bleed:y">
            <img src="images/srilanka/jack.JPG" alt="Surfboard">
          </div>
          

        <!-- <h2 class="bold-interruption book-element" style="bottom: 35%; right: 15%;">India<br>Adjacent</h2> -->

        <!-- Text -->

        <div class="display-title narrow crisp book-element"
        style="top: 1%; left: 0%; width: 20%;">
            <span class="line" style="--indent: 0ch">Sri</span>
            <span class="line" style="--indent: 1ch">Lan</span>
            <span class="line" style="--indent: 0.5ch">Ka</span>
        </div>

        <div class="lorem-block book-element" style="top: 320px; left: 300px; width: 23%; height: 400px; opacity: 0.3">
            on a winters night in the usual early hours of the morning with uni friends, a conversation was had. surprisingly, flights to sri lanka were booked the next morning.
          </div>
          
          <div class="lorem-block book-element" style="top: 2500px; left: 400px; width: 18%; height: 400px; opacity: 0.3;">
            we spent five days - an intented two - in hiriketya, a small surf town on the south coast. it was a trip of contrasts - the lush green countryside and tea plantations, the chaotic, noisy towns and cities.
        </div>

        <!-- <div class="metadata-stamp book-element" style="bottom: 25%; right: 15%;">
          Sri Lanka<br>12/16/19<br>3:14 PM
        </div> -->
      </div>

      <!-- SPREAD 3 -->
      <div class="book-spread" id="spread-3" style="min-height: 2800px;">
        <div class="center-spine"></div>

        <span class="section-number book-element" style="top: 180px; left: 40px;">03</span>

        <div class="book-image book-element" style="top: 5%; left: 0%; width: 50%; height: 35%;" data-img="images/wimbledon/241DCA62-6E63-4354-98FB-4E981518D43F_1_201_a.jpeg">
            <img src="images/wimbledon/241DCA62-6E63-4354-98FB-4E981518D43F_1_201_a.jpeg" alt="court1">
        </div>
        <div class="book-image book-element" style="top: 42%; left: 52%; width: 43%; height: 13%;" data-img="images/wimbledon/IMG_6048.JPG">
            <img src="images/wimbledon/IMG_6048.JPG" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 42%; left: 30%; width: 20%; height: 13%;"
            data-img="images/wimbledon/IMG_6039.JPG"
            data-blob="shape:square,size:1.5,seed:42,rotation:90,x:850,y:600,bleed:y">
            <img src="images/wimbledon/IMG_6039.JPG" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 57%; left: 2%; width: 23%; height: 16%;" data-img="images/wimbledon/IMG_6038.JPG">
            <img src="images/wimbledon/IMG_6038.JPG" alt="court1-2">
        </div>


        <div class="book-image book-element" style="top: 57%; left: 55%; width: 10%; height: 6%;" data-img="images/wimbledon/88C92D5E-87DC-413F-9744-4ED355222587_1_201_a.jpeg">
            <img src="images/wimbledon/88C92D5E-87DC-413F-9744-4ED355222587_1_201_a.jpeg" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 64%; left: 55%; width: 10%; height: 6%;" data-img="images/wimbledon/241F7BD9-885B-4783-BCB4-FA56C6696DD1_1_105_c.jpeg">
            <img src="images/wimbledon/241F7BD9-885B-4783-BCB4-FA56C6696DD1_1_105_c.jpeg" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 71%; left: 55%; width: 10%; height: 6%;" data-img="images/wimbledon/F6028214-BE46-4FEF-8B9E-7360EE5F62DA_1_105_c.jpeg">
            <img src="images/wimbledon/F6028214-BE46-4FEF-8B9E-7360EE5F62DA_1_105_c.jpeg" alt="court1-2">
        </div>

        <div class="book-image book-element" style="top: 75%; left:6%; width: 21%; height: 12%;" data-img="images/wimbledon/IMG_6024.JPG">
            <img src="images/wimbledon/IMG_6024.JPG" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 85%; left:25%; width: 21%; height: 12%;" data-img="images/wimbledon/IMG_6023.JPG">
            <img src="images/wimbledon/IMG_6023.JPG" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 90%; left:4%; width: 16%; height: 9%;"
             data-img="images/wimbledon/IMG_6019.JPG"
             data-blob="shape:square,size:1.5,seed:42,rotation:90,x:850,y:800,bleed:y">
            <img src="images/wimbledon/IMG_6019.JPG" alt="court1-2">
        </div>

        <div class="book-image book-element" style="top: 79%; left:70%; width: 22%; height: 18%;"
            data-img="images/wimbledon/IMG_6026.JPG"
            data-blob="shape:square, size:1.5,seed:45,rotation:90,x:150,y:220, bleed:y">
            <img src="images/wimbledon/IMG_6026.JPG" alt="court1-2">
        </div>

        <!-- Text -->

        <div class="display-title narrow crisp book-element"
        style="top: 5%; right: 14%; width: 25%;">
            <span class="line" style="--indent: 0ch">Wim</span>
            <span class="line" style="--indent: 1ch">bledon</span>
            <span class="line" style="--indent: 0.5ch"></span>
        </div>
        <!-- WIMBLEDON TEXT BLOCK -->
        <div class="ball-copy book-element" style="top: 18%; right: 8%;">
        <p>
            tennis is a sport demanding precision and split-second timing as players
            track the bright yellow ball flying across the net with incredible speed
            while maintaining perfect form and concentration throughout each intense
            rally where every serve and return requires flawless execution and mental
            fortitude as competitors push their physical limits while reading their
            opponent's strategy and anticipating every bounce and spin that could
            determine the outcome of crucial points in this beautiful game of angles
            and athleticism that has captivated audiences worldwide with its
            combination of power grace and tactical brilliance on every court
        </p>
        <!-- the seam lives above the text and “erases” along a smooth curve -->
        <div class="ball-seam"></div>
        </div>
        <div class="text-block book-element" style="top: 1350px; left: 55px; width: 20%; height: 400px; opacity: 0.3;">
            some text about ricky winning wimbledon and we all went to wimbledon to see it.
        </div>
    </div>
    <div class="book-spread" id="spread-4" style="min-height: 3000px;">
        <div class="center-spine"></div>

        <span class="section-number book-element" style="top: 30px; right: 40px;">04</span>
        <div class="book-image book-element" style="top: 2.5%; left:60%; width: 38%; height: 10%;"
            data-img="images/nyc/IMG_1950.JPG">
            <!-- data-blob="size:1,seed:15,rotation:90,x:850,y:800,bleed:y"> -->
            <img src="images/nyc/IMG_1950.JPG" alt="court1-2">
        </div>


        <div class="book-image book-element" style="top: 16%; left:10%; width: 40%; height: 10%;" data-img="images/nyc/IMG_1920.JPG">
            <img src="images/nyc/IMG_1920.JPG" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 26.5%; left:10%; width: 40%; height: 10%;" 
            data-img="images/nyc/IMG_1923.JPG"
            data-blob="shape:square,size:2.8,seed:42,rotation:90,x:650,y:500,bleed:y">
            <img src="images/nyc/IMG_1923.JPG" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 37%; left:10%; width: 40%; height: 10%;" data-img="images/nyc/IMG_1945.JPG">
            <img src="images/nyc/IMG_1945.JPG" alt="court1-2">
        </div>

        <div class="book-image book-element" style="top: 18%; left:62%; width: 30%; height: 27%;" 
            data-img="images/nyc/IMG_1926.JPG"
            data-blob="size:2.8,seed:22,rotation:90,x:650,y:500,bleed:n">
            <img src="images/nyc/IMG_1926.JPG" alt="court1-2">
        </div>
        
        <div class="book-image book-element" style="top: 48%; left:75%; width: 25%; height: 8%;" data-img="images/nyc/jamie/56CCE684-A708-47D7-A467-9BA17E37F2FD.jpeg">
            <img src="images/nyc/jamie/56CCE684-A708-47D7-A467-9BA17E37F2FD.jpeg" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 48%; left:50%; width: 25%; height: 8%;" data-img="images/nyc/jamie/7C27F060-F794-49CF-AC2A-FBB62A2CF31C.jpeg">
            <img src="images/nyc/jamie/7C27F060-F794-49CF-AC2A-FBB62A2CF31C.jpeg" alt="court1-2">
        </div>

        <div class="book-image book-element" style="top: 53%; left:5%; width: 10%; height: 5%;" data-img="images/nyc/5789E867-66B8-4D56-B552-C84E911B6699.jpeg">
            <img src="images/nyc/5789E867-66B8-4D56-B552-C84E911B6699.jpeg" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 53%; left:18%; width: 10%; height: 4%;" data-img="images/nyc/994F8930-27B7-4B2D-88A7-0175F1C58DC0.jpeg">
            <img src="images/nyc/994F8930-27B7-4B2D-88A7-0175F1C58DC0.jpeg" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 58%; left:22%; width: 25%; height: 8%;" data-img="images/nyc/CEF3B6CC-8351-4216-93D3-DB485BDD85F7.jpeg">
            <img src="images/nyc/CEF3B6CC-8351-4216-93D3-DB485BDD85F7.jpeg" alt="court1-2">
        </div>

        <div class="book-image book-element" style="top: 62%; left:78%; width: 20%; height: 15%;" data-img="images/nyc/jamie/3F6A3AA2-9E16-48EB-A13D-215E0A6B0890.jpeg">
            <img src="images/nyc/jamie/3F6A3AA2-9E16-48EB-A13D-215E0A6B0890.jpeg" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 69%; left:63%; width: 12%; height: 7%;" data-img="images/nyc/jamie/15116121-DF50-4FD7-B00A-930BAD4CB5F0_1_201_a.jpeg">
            <img src="images/nyc/jamie/15116121-DF50-4FD7-B00A-930BAD4CB5F0_1_201_a.jpeg" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 63%; left:52%; width: 20%; height: 5%;" data-img="images/nyc/jamie/FF209432-11EB-4FBD-B03E-7F9C7D04B107.jpeg">
            <img src="images/nyc/jamie/FF209432-11EB-4FBD-B03E-7F9C7D04B107.jpeg" alt="court1-2">
        </div>

        <div class="book-image book-element" style="top: 75%; left:4%; width: 23%; height: 18%;"
            data-img="images/nyc/C8546B3A-0268-42F4-A425-665F55DBF869.jpeg"
            data-blob="size:1,seed:9,rotation:90,x:690,y:680,bleed:n">
            <img src="images/nyc/C8546B3A-0268-42F4-A425-665F55DBF869.jpeg" alt="court1-2">
        </div>

        <div class="book-image book-element" style="top: 79%; left:52%; width: 35%; height: 8%;" data-img="images/nyc/C6996D52-0ADB-4464-8AD1-5A2C12C1D282.jpeg">
            <img src="images/nyc/C6996D52-0ADB-4464-8AD1-5A2C12C1D282.jpeg" alt="court1-2">
        </div>

        <div class="book-image book-element" style="top: 89%; left:60%; width: 16%; height: 10%;" data-img="images/nyc/D4388D63-7A29-434D-A637-5B4A69E1CA8E.jpeg">
            <img src="images/nyc/D4388D63-7A29-434D-A637-5B4A69E1CA8E.jpeg" alt="court1-2">
        </div>
        <div class="book-image book-element" style="top: 89%; left:33%; width: 10%; height: 10%;"
            data-img="images/nyc/FBA03E96-81CA-459B-A492-EAB6510A586B.jpeg"
            data-blob="shape:square,size:2.5,seed:9,rotation:90,x:700,y:780,bleed:y">
            <img src="images/nyc/FBA03E96-81CA-459B-A492-EAB6510A586B.jpeg" alt="court1-2">
        </div>
        <!-- Text -->

        <div class="display-title narrow crisp book-element"
        style="top: 2%; left: 2%; width: 25%;">
            <span class="line" style="--indent: 0ch">New</span>
            <span class="line" style="--indent: 1.5ch">York</span>
            <span class="line" style="--indent: 1ch">City</span>
        </div>
        <div class="lorem-block book-element" style="top: 400px; left: 810px; width: 37%; height: 100px; opacity: 0.4; column-gap: 20;">
            a trip that had been prommised for as long as i could remember. in february of 2022, despite our now expired stand-by privaledges, 5 hour plane delay and lost tickets for the comedy club in SoHo that night, we were finally on our way to new york.
        </div>
        <div class="lorem-block book-element" style="top: 1720px; left: 710px; width: 45%; height: 100px; opacity: 0.4; column-gap: 60px;">
            on a sunday morning we decided that a day together, avoiding the usual slightly chaotic logistics of a 6 person onterage, would be a good idea. we got the metro to brooklyn, explored round the bridge and then headed to williamsburg. we went to some vintage shops, had an explore, drank beer and played pool - this was my favorite day.
        </div>
    </div>
    </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox">
    <span class="lightbox-close">&times;</span>
    <div class="lightbox-content">
      <img src="" alt="Full view">
    </div>
  </div>

  <script>
    // FIXED: Automatic spine blending - Ultra-tight detection
    function applySpineBlending() {
      document.querySelectorAll('.book-spread').forEach(spread => {
        spread.querySelectorAll('.book-image').forEach(image => {
          const leftStyle = image.style.left || '0%';
          const leftPercent = parseFloat(leftStyle.replace('%', ''));
          const widthStyle = image.style.width || '20%';
          const widthPercent = parseFloat(widthStyle.replace('%', ''));
          const rightPercent = leftPercent + widthPercent;

          const spineZoneLeft = 48;
          const spineZoneRight = 52;

          image.classList.remove('spine-adjacent', 'spine-spanning');
          image.style.transform = '';
          image.style.transformOrigin = '';
          image.querySelectorAll('.spine-shadow').forEach(shadow => shadow.remove());

          if (rightPercent > spineZoneLeft && leftPercent < spineZoneRight) {
            image.classList.add('spine-adjacent');

            if (leftPercent < 50 && rightPercent > 50) {
              image.classList.add('spine-spanning');
              image.style.transform = 'perspective(2000px) rotateX(0.5deg)';

              const centerShadow = document.createElement('div');
              centerShadow.className = 'spine-shadow spine-shadow-center';
              centerShadow.style.cssText = `
                position: absolute;
                left: 45%;
                right: 45%;
                top: 0;
                bottom: 0;
                background: linear-gradient(to right,
                  transparent 0%,
                  rgba(0,0,0,0.3) 30%,
                  rgba(0,0,0,0.5) 50%,
                  rgba(0,0,0,0.3) 70%,
                  transparent 100%);
                pointer-events: none;
                z-index: 5;
              `;
              image.appendChild(centerShadow);
            } else {
              const imageCenter = leftPercent + (widthPercent / 2);
              if (imageCenter < 50) {
                image.style.transformOrigin = 'right center';
                image.style.transform = 'perspective(2000px) rotateY(1.5deg)';

                const shadow = document.createElement('div');
                shadow.className = 'spine-shadow spine-shadow-right';
                shadow.style.cssText = `
                  position: absolute;
                  right: 0;
                  top: 0;
                  bottom: 0;
                  width: 20px;
                  background: linear-gradient(to left,
                    rgba(0,0,0,0.4) 0%,
                    rgba(0,0,0,0.2) 50%,
                    transparent 100%);
                  pointer-events: none;
                  z-index: 5;
                `;
                image.appendChild(shadow);
              } else {
                image.style.transformOrigin = 'left center';
                image.style.transform = 'perspective(2000px) rotateY(-1.5deg)';

                const shadow = document.createElement('div');
                shadow.className = 'spine-shadow spine-shadow-left';
                shadow.style.cssText = `
                  position: absolute;
                  left: 0;
                  top: 0;
                  bottom: 0;
                  width: 20px;
                  background: linear-gradient(to right,
                    rgba(0,0,0,0.4) 0%,
                    rgba(0,0,0,0.2) 50%,
                    transparent 100%);
                  pointer-events: none;
                  z-index: 5;
                `;
                image.appendChild(shadow);
              }
            }
          }
        });
      });
    }

    document.addEventListener('DOMContentLoaded', applySpineBlending);
    window.addEventListener('resize', applySpineBlending);

    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });

    // Lightbox
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = lightbox.querySelector('img');

    document.querySelectorAll('.book-image').forEach(image => {
      image.addEventListener('click', function() {
        const imgSrc = this.getAttribute('data-img') || this.querySelector('img').src;
        lightboxImg.src = imgSrc;
        lightbox.style.display = 'flex';
        requestAnimationFrame(() => lightbox.classList.add('active'));
      });
    });

    lightbox.addEventListener('click', function() {
      this.classList.remove('active');
      setTimeout(() => { if (!this.classList.contains('active')) this.style.display = 'none'; }, 400);
    });

    // Parallax disabled to keep elements in perfect relative position
    // window.addEventListener('scroll', () => {
    //   const scrolled = window.pageYOffset;
    //   const spreads = document.querySelectorAll('.book-spread');

    //   spreads.forEach(spread => {
    //     const rect = spread.getBoundingClientRect();
    //     const images = spread.querySelectorAll('.book-image');
    //     const textElements = spread.querySelectorAll('.book-notes, .section-number, .entry-title, .display-title');

    //     if (rect.top < window.innerHeight && rect.bottom > 0) {
    //       images.forEach(image => {
    //         const speed = 0.01;
    //         const yPos = -(scrolled * speed);
    //         let existingTransform = '';
    //         if (image.classList.contains('spine-adjacent')) {
    //           if (image.classList.contains('spine-spanning')) existingTransform = 'perspective(2000px) rotateX(0.5deg)';
    //           else if (image.style.transform.includes('rotateY(1.5deg)')) existingTransform = 'perspective(2000px) rotateY(1.5deg)';
    //           else if (image.style.transform.includes('rotateY(-1.5deg)')) existingTransform = 'perspective(2000px) rotateY(-1.5deg)';
    //         }
    //         image.style.transform = `${existingTransform} translateY(${yPos}px)`;
    //       });

    //       textElements.forEach(text => {
    //         const textSpeed = 0.01;
    //         const textYPos = -(scrolled * textSpeed);
    //         text.style.transform = `translateY(${textYPos}px)`;
    //       });
    //     }
    //   });
    // });

    // Fade-in
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => { if (entry.isIntersecting) entry.target.style.opacity = '1'; });
    }, { threshold: 0.1 });

    document.querySelectorAll('.book-element').forEach(element => {
      element.style.opacity = '0';
      element.style.transition = 'opacity 0.8s ease-out';
      observer.observe(element);
    });

    setTimeout(applySpineBlending, 100);

    // Blob generation system
    //  - size: 1.2 = 20% bigger, 0.8 = 20% smaller
    //  - seed: Different numbers = different organic shapes (same number = same shape)
    //  - rotation: -6 = slightly counter-clockwise, 45 = 45° clockwise
    //  - x,y: Position within the image (500,500 = center, 300,200 = upper-left area)
    //  - bleed: y/yes/true = blob can extend beyond image boundaries into journal
    //  - shape: 'blob' (default) or 'square' for rectangular shapes

    function generateBlobPath(size = 1, seed = 1) {
      const random = (seed) => {
        let x = Math.sin(seed) * 10000;
        return x - Math.floor(x);
      };
      
      // Natural blob parameters with variation
      const baseSize = 200 * size;
      const points = 8;
      const roughness = 0.3;
      const cx = 500, cy = 500;
      
      let path = 'M';
      const angles = [];
      
      for (let i = 0; i < points; i++) {
        const angle = (i / points) * 2 * Math.PI;
        const radiusVariation = 1 + (random(seed + i * 7) - 0.5) * roughness;
        const angleOffset = (random(seed + i * 11) - 0.5) * 0.3;
        
        const radius = baseSize * radiusVariation;
        const actualAngle = angle + angleOffset;
        
        const x = cx + Math.cos(actualAngle) * radius;
        const y = cy + Math.sin(actualAngle) * radius;
        
        angles.push({ x, y, angle: actualAngle });
      }
      
      // Create smooth curves between points
      for (let i = 0; i < points; i++) {
        const curr = angles[i];
        const next = angles[(i + 1) % points];
        const prev = angles[i === 0 ? points - 1 : i - 1];
        
        if (i === 0) path += `${curr.x} ${curr.y}`;
        
        // Control points for smooth curves
        const cp1x = curr.x + Math.cos(curr.angle + Math.PI/2) * baseSize * 0.2;
        const cp1y = curr.y + Math.sin(curr.angle + Math.PI/2) * baseSize * 0.2;
        const cp2x = next.x - Math.cos(next.angle + Math.PI/2) * baseSize * 0.2;
        const cp2y = next.y - Math.sin(next.angle + Math.PI/2) * baseSize * 0.2;
        
        path += ` C${cp1x} ${cp1y}, ${cp2x} ${cp2y}, ${next.x} ${next.y}`;
      }
      path += 'z';
      
      return path;
    }

    function generateSquarePath(size = 1, imageElement = null) {
      // Get image element dimensions to match rectangle to image aspect ratio
      let width = 400, height = 400; // default square
      
      if (imageElement) {
        const imgRect = imageElement.getBoundingClientRect();
        const aspectRatio = imgRect.width / imgRect.height;
        
        if (aspectRatio > 1) {
          // Landscape: keep width, adjust height
          width = 400 * size;
          height = (400 / aspectRatio) * size;
        } else {
          // Portrait: keep height, adjust width  
          height = 400 * size;
          width = (400 * aspectRatio) * size;
        }
      } else {
        // Square when no image reference
        width = height = 400 * size;
      }
      
      const cx = 500, cy = 500;
      const left = cx - width/2;
      const right = cx + width/2;
      const top = cy - height/2;
      const bottom = cy + height/2;
      
      // Perfect rectangle - no rounded corners or irregularities
      return `M${left} ${top}
              L${right} ${top}
              L${right} ${bottom}
              L${left} ${bottom}
              z`;
    }

    function addBlobToImage(imageElement, options = {}) {
      const {
        size = 1,
        seed = Math.random() * 1000,
        rotation = Math.random() * 360,
        position = { x: Math.random() * 400 + 300, y: Math.random() * 400 + 300 },
        bleed = false,
        shape = 'blob'
      } = options;
      
      if (!imageElement.classList.contains('has-spot')) {
        imageElement.classList.add('has-spot');
      }
      
      if (bleed) {
        imageElement.classList.add('has-spot-bleed');
      }
      
      const shapePath = shape === 'square' ? generateSquarePath(size, imageElement) : generateBlobPath(size, seed);
      const uniqueId = `blob-${Math.floor(Math.random() * 10000)}`;
      
      const spotDiv = document.createElement('div');
      spotDiv.className = bleed ? 'image-spot image-spot--bleed' : 'image-spot image-spot--contained';
      spotDiv.innerHTML = `
        <svg viewBox="0 0 1000 1000" aria-hidden="true">
          <defs>
            <filter id="grain-${uniqueId}" x="-20%" y="-20%" width="140%" height="140%">
              <feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="2" seed="${seed}"/>
              <feColorMatrix type="saturate" values="0" />
              <feComponentTransfer>
                <feFuncA type="linear" slope="0.45"/>
              </feComponentTransfer>
            </filter>
            <filter id="grainCoarse-${uniqueId}" x="-20%" y="-20%" width="140%" height="140%">
              <feTurbulence type="fractalNoise" baseFrequency="0.22" numOctaves="2" seed="${seed + 100}"/>
              <feColorMatrix type="saturate" values="0" />
              <feComponentTransfer>
                <feFuncA type="linear" slope="0.28"/>
              </feComponentTransfer>
            </filter>
            <filter id="roughen-${uniqueId}" x="-30%" y="-30%" width="160%" height="160%">
              <feTurbulence type="fractalNoise" baseFrequency="0.018" numOctaves="2" seed="${seed + 200}" result="turb"/>
              <feDisplacementMap in="SourceGraphic" in2="turb" scale="9" xChannelSelector="R" yChannelSelector="G"/>
              <feGaussianBlur stdDeviation="0.9" />
            </filter>
            <radialGradient id="roundFade-${uniqueId}" cx="50%" cy="50%" r="65%">
              <stop offset="0%" stop-color="var(--blob-color)" stop-opacity="0.45"/>
              <stop offset="70%" stop-color="var(--blob-color)" stop-opacity="0.22"/>
              <stop offset="100%" stop-color="var(--blob-color)" stop-opacity="0.00"/>
            </radialGradient>
            <path id="shapePath-${uniqueId}" d="${shapePath}"/>
            <clipPath id="shapeClip-${uniqueId}">
              <use href="#shapePath-${uniqueId}" />
            </clipPath>
          </defs>
          <g transform="translate(${position.x - 500}, ${position.y - 500}) rotate(${rotation} 500 500)">
            <use href="#shapePath-${uniqueId}" class="hue-layer" fill="var(--blob-color)" filter="url(#roughen-${uniqueId})" style="opacity: var(--blob-hue-opacity)" />
            <use href="#shapePath-${uniqueId}" class="density-layer" fill="url(#roundFade-${uniqueId})" filter="url(#roughen-${uniqueId})" style="opacity: var(--blob-density-opacity)" />
            <use href="#shapePath-${uniqueId}" class="burn-layer" fill="var(--blob-color)" filter="url(#roughen-${uniqueId})" style="opacity: var(--blob-burn-opacity)" />
            <g clip-path="url(#shapeClip-${uniqueId})">
              <use href="#shapePath-${uniqueId}" class="grain" fill="#000" filter="url(#grain-${uniqueId})" style="opacity: var(--blob-grain-opacity)" />
              <use href="#shapePath-${uniqueId}" class="grain2" fill="#000" filter="url(#grainCoarse-${uniqueId})" style="opacity: var(--blob-grain2-opacity)" />
            </g>
          </g>
        </svg>
      `;
      
      imageElement.appendChild(spotDiv);
      return spotDiv;
    }

    // Auto-initialize blobs from HTML attributes
    function initializeBlobs() {
      document.querySelectorAll('.book-image[data-blob]').forEach(image => {
        const blobData = image.getAttribute('data-blob');
        if (blobData === 'true' || blobData === '') {
          // Simple blob with defaults
          addBlobToImage(image);
        } else {
          // Parse blob parameters
          const params = {};
          blobData.split(',').forEach(param => {
            const [key, value] = param.split(':').map(s => s.trim());
            if (key && value) {
              if (key === 'size') params.size = parseFloat(value);
              else if (key === 'seed') params.seed = parseInt(value);
              else if (key === 'rotation') params.rotation = parseFloat(value);
              else if (key === 'bleed') params.bleed = value === 'y' || value === 'yes' || value === 'true';
              else if (key === 'shape') params.shape = value;
              else if (key === 'x' || key === 'y') {
                if (!params.position) params.position = {};
                params.position[key] = parseFloat(value);
              }
            }
          });
          addBlobToImage(image, params);
        }
      });
    }

    function initBallSeam(){
    document.querySelectorAll('.ball-copy').forEach(el=>{
        const d = getComputedStyle(el).getPropertyValue('--diameter');
        const seamWidth = getComputedStyle(el).getPropertyValue('--seam-width');
        const softness = getComputedStyle(el).getPropertyValue('--seam-soften');
        const openness = parseFloat(getComputedStyle(el).getPropertyValue('--seam-curve')) || 0.65;

        // Build an SVG mask as a data-URL:
        // White = keep, black = cut out (our seam) - but inverted
        const svg = `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000" preserveAspectRatio="none">
        <defs>
            <filter id="blur"><feGaussianBlur stdDeviation="${softness || 10}"/></filter>
            <mask id="m">
            <rect width="100%" height="100%" fill="black"/>
            <!-- Single curved seam (cubic) -->
            <g filter="url(#blur)">
                <path d="
                M 0 ${300 + 200*(1-openness)}
                C ${250} ${250*openness}, ${750} ${750*(2-openness)-400}, 1000 ${700 - 200*(1-openness)}
                " stroke="white" stroke-width="40" stroke-linecap="round" fill="none"/>
            </g>
            </mask>
        </defs>
        <!-- Render white where we want to show text -->
        <rect width="100%" height="100%" fill="white" mask="url(#m)"/>
        </svg>`.trim();

        const dataUrl = `url('data:image/svg+xml;utf8,${encodeURIComponent(svg)}')`;
        el.style.setProperty('--seam-mask', dataUrl);
    });
    };

    // Initialize blobs after DOM loads
    document.addEventListener('DOMContentLoaded', () => {
      initializeBlobs();
      initBallSeam();
    });
  </script>
</body>
</html>